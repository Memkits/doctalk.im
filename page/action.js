// Generated by CoffeeScript 1.3.3
var create_topic, focus_type, listen_topic, set_avatar, set_name, slide_right, start_posts, start_topic, sync_post;

create_topic = function() {
  var text;
  text = $('#create').val().trim();
  if (text.length > 0) {
    s.emit('create-topic', text);
  }
  $('#create').val('');
  return $('#create').fadeOut();
};

focus_type = function() {
  if ($('body').scrollLeft() > 100) {
    return $('body').animate({
      scrollLeft: 0
    }, function() {
      return $('#type').focus();
    });
  } else {
    return $('#type').focus();
  }
};

slide_right = function() {
  var left, screen_width;
  left = $('body').scrollLeft();
  screen_width = $(window).width();
  if (left < 10) {
    return $('body').animate({
      scrollLeft: 2000 - screen_width
    });
  } else {
    return focus_type();
  }
};

set_name = function() {
  var name;
  name = $('#set-name').val();
  ls.name = name;
  return s.emit('set-name', name);
};

set_avatar = function() {
  ls.avatar = $('#set-avatar').val();
  $('#avatar').attr('src', ls.avatar);
  return s.emit('set-avatar', ls.avatar);
};

listen_topic = function(obj) {
  return add_topic(obj);
};

start_topic = function(list) {
  var end;
  list.forEach(listen_topic);
  end = last(list);
  show('end', end);
  return s.emit('goto-topic', end.topic_id);
};

start_posts = function(list) {
  $('#show').empty();
  return list.forEach(add_post);
};

sync_post = function(obj) {
  var elem, post_id, query;
  post_id = obj.post_id;
  query = ".unit span[post_id='" + post_id + "']";
  show(query);
  elem = $(query);
  show(elem);
  if (found(elem)) {
    return elem.text(obj.text);
  } else {
    return add_post(obj);
  }
};
